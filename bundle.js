(()=>{"use strict";var t={56(t,e,r){t.exports=function(t){var e=r.nc;e&&t.setAttribute("nonce",e)}},72(t){var e=[];function r(t){for(var r=-1,n=0;n<e.length;n++)if(e[n].identifier===t){r=n;break}return r}function n(t,n){for(var s={},a=[],o=0;o<t.length;o++){var h=t[o],c=n.base?h[0]+n.base:h[0],l=s[c]||0,d="".concat(c," ").concat(l);s[c]=l+1;var u=r(d),p={css:h[1],media:h[2],sourceMap:h[3],supports:h[4],layer:h[5]};if(-1!==u)e[u].references++,e[u].updater(p);else{var m=i(p,n);n.byIndex=o,e.splice(o,0,{identifier:d,updater:m,references:1})}a.push(d)}return a}function i(t,e){var r=e.domAPI(e);return r.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;r.update(t=e)}else r.remove()}}t.exports=function(t,i){var s=n(t=t||[],i=i||{});return function(t){t=t||[];for(var a=0;a<s.length;a++){var o=r(s[a]);e[o].references--}for(var h=n(t,i),c=0;c<s.length;c++){var l=r(s[c]);0===e[l].references&&(e[l].updater(),e.splice(l,1))}s=h}}},113(t){t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},208(t,e,r){r.d(e,{A:()=>o});var n=r(601),i=r.n(n),s=r(314),a=r.n(s)()(i());a.push([t.id,":root{\n  --empty-tile-color: blue;\n  --hit-tile-color: red;\n  --miss-tile-color: green;\n  --ship-tile-color: gray;\n  --sunk-tile-color: black;\n\n  --hover-tile-color: purple;\n}\n\nbody{\n  display: flex;\n  align-items: center;\n\n  flex-direction: column;\n}\n\nsection#board-display{\n  display: flex;\n\n  width: 90vw;\n\n  gap: 50px;\n}\n\ndiv#interactive-board, div#static-board{\n  display: grid;\n  gap: 5px;\n  flex: 1;\n}\n\n#interactive-board .empty-tile:hover{\n  background-color: var(--hover-tile-color);\n}\n\n.empty-tile, .hit, .miss, .ship, .sunk{\n  aspect-ratio: 1;\n}\n\n.empty-tile{\n  background-color: var(--empty-tile-color);\n}\n\n.hit{\n  background-color: var(--hit-tile-color);\n}\n\n.miss{\n  background-color: var(--miss-tile-color);\n}\n\n.ship{\n  background-color: var(--ship-tile-color);\n}\n\n.sunk{\n  background-color: var(--sunk-tile-color);\n}\n\n#text-bar{\n  text-align: center;\n  font-size: 36px;\n}\n\ndialog{\n  width: 100vw;\n  height: 100vh;\n}",""]);const o=a},314(t){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var r="",n=void 0!==e[5];return e[4]&&(r+="@supports (".concat(e[4],") {")),e[2]&&(r+="@media ".concat(e[2]," {")),n&&(r+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),r+=t(e),n&&(r+="}"),e[2]&&(r+="}"),e[4]&&(r+="}"),r}).join("")},e.i=function(t,r,n,i,s){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(n)for(var o=0;o<this.length;o++){var h=this[o][0];null!=h&&(a[h]=!0)}for(var c=0;c<t.length;c++){var l=[].concat(t[c]);n&&a[l[0]]||(void 0!==s&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=s),r&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=r):l[2]=r),i&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=i):l[4]="".concat(i)),e.push(l))}},e}},540(t){t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},601(t){t.exports=function(t){return t[1]}},659(t){var e={};t.exports=function(t,r){var n=function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},825(t){t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(r){!function(t,e,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var i=void 0!==r.layer;i&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,i&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var s=r.sourceMap;s&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(n,t,e.options)}(e,t,r)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var s=e[n]={id:n,exports:{}};return t[n](s,s.exports,r),s.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.nc=void 0;var n=r(72),i=r.n(n),s=r(825),a=r.n(s),o=r(659),h=r.n(o),c=r(56),l=r.n(c),d=r(540),u=r.n(d),p=r(113),m=r.n(p),f=r(208),y={};y.styleTagTransform=m(),y.setAttributes=l(),y.insert=h().bind(null,"head"),y.domAPI=a(),y.insertStyleElement=u(),i()(f.A,y),f.A&&f.A.locals&&f.A.locals;const v={BOARD_WIDTH:10,BOARD_HEIGHT:10,SHIPS:[5,4,3,3,2],PLAYER_1:"human",PLAYER_2:"human"};class g{constructor(t){this.length=t,this.hitCount=0,this.sunk=!1}hit(){this.hitCount++}isSunk(){return this.hitCount>=this.length}}class x{constructor(){this.width=v.BOARD_WIDTH,this.height=v.BOARD_HEIGHT,this.ships=new Map(v.SHIPS.map(t=>[new g(t),[]])),this.shipCount=v.SHIPS.length,this.board=Array.from(Array(this.height),()=>Array(this.width).fill(null))}placeShip(t,e,r,n){const i=t.length;if(e>this.width-1||r>this.height-1)throw new Error("index out of board range");if(e+i>this.width&&!n||r+i>this.height&&n)throw new Error("length out of range");let s=[];for(let t=n?r:e,a=0;a<i;a++,t++){const i=n?[t,e]:[r,t];if(null!==this.board[i[0]][i[1]])throw new Error("ship overlap");s.push(i)}s.forEach(([e,r])=>{this.board[e][r]=t}),this.ships.set(t,s)}receiveAttack(t,e){if(t>v.BOARD_WIDTH-1||e>v.BOARD_HEIGHT-1)throw new Error("index out of range");const r=this.board[e][t];if("X"===r||"O"===r||"S"===r)throw new Error("index previously chosen");if("object"==typeof r&&null!==r){if(r.hit(),r.isSunk()){if(this.shipCount--,this.ships.get(r).forEach(([t,e])=>this.board[t][e]="S"),!0===this.allSunk())return"loss"}else this.board[e][t]="X";return"hit"}return this.board[e][t]="O","miss"}allSunk(){return!(this.shipCount>0)}}const b=class{constructor(){this.openIndexes=this.#t(),this.nextIndexes=[]}#t(){let t=new Set;for(let e=0;e<v.BOARD_HEIGHT;e++)for(let r=0;r<v.BOARD_WIDTH;r++)t.add(`[${r},${e}]`);return t}#e(t){this.nextIndexes=[];for(let e=-1;e<2;e+=2){const r=[t[0]+e,t[1]],n=[t[0],t[1]+e];this.openIndexes.has(`[${r[0]},${r[1]}]`)&&this.nextIndexes.push(r),this.openIndexes.has(`[${n[0]},${n[1]}]`)&&this.nextIndexes.push(n)}}#r(t){let e=this.nextIndexes.pop();const r=t.receiveAttack(e[0],e[1]);return this.openIndexes.delete(`[${e[0]},${e[1]}]`),"hit"===r&&this.#e(e),r}attack(t){let e;if(this.nextIndexes.length>0)e=this.#r(t);else{const r=Array.from(this.openIndexes),n=Math.floor(Math.random()*this.openIndexes.size),i=JSON.parse(r.splice(n,1)[0]);this.openIndexes.delete(`[${i[0]},${i[1]}]`),e=t.receiveAttack(i[0],i[1]),"hit"===e&&this.#e(i)}return e}};class w{constructor(t){this.type=t,this.gameboard=new x,"computer"===t&&(this.smartAttack=new b)}}const T={randomPlace(t){const e=[!0,!1];for(let[r,n]of t.ships){const n=e[Math.floor(2*Math.random())],i=n?t.width-1:t.width-r.length,s=n?t.height-r.length:t.height-1;let a=!1;for(;!a;){const e=Math.floor(Math.random()*(i+1)),o=Math.floor(Math.random()*(s+1));try{t.placeShip(r,e,o,n),a=!0}catch(t){}}}}};class A{constructor(t){this.width=v.BOARD_WIDTH,this.height=v.BOARD_HEIGHT,this.containerId=t,this.htmlContainer=document.getElementById(this.containerId)}render(t,e=!0){this.htmlContainer.innerHTML="",this.htmlContainer.style.gridTemplate=`repeat(${this.width}, 1fr) / repeat(${this.height}, 1fr)`;const r=t.board;for(let t=0;t<this.height;t++)for(let n=0;n<this.width;n++){const i=document.createElement("div");switch(i.dataset.index=JSON.stringify([t,n]),r[t][n]){case null:i.classList.add("empty-tile");break;case"X":i.classList.add("hit");break;case"O":i.classList.add("miss");break;case"S":i.classList.add("sunk");break;default:e?i.classList.add("ship"):i.classList.add("empty-tile")}this.htmlContainer.appendChild(i)}}}const P=new w(v.PLAYER_1),I=new w(v.PLAYER_2),k=new A("interactive-board"),C=new A("static-board"),E=new class{constructor(t){this.htmlContainer=document.getElementById(t)}renderPlayer(t){this.htmlContainer.innerHTML="",this.htmlContainer.textContent=`Current player: (${t})`}renderWinner(t){this.htmlContainer.innerHTML="",this.htmlContainer.textContent=`Player (${t}) is the Winner!`}}("text-bar"),S=new class{constructor(t,e){this.htmlContainer=document.getElementById(t),this.title=document.getElementById(e)}render(t){this.title.textContent=`Hand computer to Player (${t})`,this.htmlContainer.showModal(),this.htmlContainer.addEventListener("click",()=>this.htmlContainer.close())}}("player-swap-dialog","player-swap-title"),_=new class{constructor(t,e,r,n,i,s){this.player_1=t,this.player_2=e,this.turnArr=[this.player_1,this.player_2],this.playerTextArr=["P1","P2"],this.turn=0,this.currentPlayer=this.turnArr[this.turn],this.currentPlayerText=this.playerTextArr[this.turn],this.otherPlayer=this.turnArr[(this.turn+1)%2],this.static_board=n,this.interactive_board=r,this.textBar=i,this.swapScreen=s,this.pause=!1}setup(){T.randomPlace(this.player_1.gameboard),T.randomPlace(this.player_2.gameboard),this.#n(),this.textBar.renderPlayer(this.currentPlayerText)}handleEvent(t){if(this.pause)return;const e=t.target;if(e.classList.contains("empty-tile")){const t=JSON.parse(e.dataset.index);if(!0===this.#i(t))return;"computer"===this.currentPlayer.type?this.#s():(this.pause=!0,setTimeout(()=>{this.#n(),this.swapScreen.render(this.currentPlayerText),this.pause=!1},1e3))}}run(){"computer"===this.currentPlayer.type&&this.#s(),this.interactive_board.htmlContainer.addEventListener("click",this)}#n(){this.interactive_board.render(this.otherPlayer.gameboard,!1),this.static_board.render(this.currentPlayer.gameboard)}#i(t){const e=this.otherPlayer.gameboard.receiveAttack(t[1],t[0]);return this.interactive_board.render(this.otherPlayer.gameboard,!1),!!this.#a(e)||(this.#o(),e)}#s(){this.pause=!0,setTimeout(()=>{const t=this.currentPlayer.smartAttack.attack(this.otherPlayer.gameboard);return this.static_board.render(this.otherPlayer.gameboard),!!this.#a(t)||(this.#o(),"computer"===this.currentPlayer.type?(this.#n(),this.#s()):this.pause=!1,t)},300)}#o(){this.turn=(this.turn+1)%2,this.currentPlayer=this.turnArr[this.turn],this.otherPlayer=this.turnArr[(this.turn+1)%2],this.currentPlayerText=this.playerTextArr[this.turn],this.textBar.renderPlayer(this.currentPlayerText)}#a(t){if("loss"===t)return this.interactive_board.htmlContainer.removeEventListener("click",this),this.textBar.renderWinner(this.currentPlayerText),!0}}(P,I,k,C,E,S);_.setup(),_.run()})();